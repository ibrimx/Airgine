---
import type { CardConfig } from "../../../lib/types/layout";

import TextCard from "./TextCard.astro";
import MediaCard from "./MediaCard.astro";
import StickerCard from "./StickerCard.astro";
import HeroCard from "./HeroCard.astro";
import PostListCard from "./PostListCard.astro";
import OverlayCard from "./OverlayCard.astro";

interface Props {
  config: CardConfig;
}

const { config } = Astro.props;

const gridSize = config.size ?? "1x1";
const rotation = config.styles?.rotation ?? 0;
const background = config.styles?.background;
const textColor = config.styles?.textColor;

// الكروت التي تملأ المساحة كاملة — بدون padding
const isFullBleed = config.variant === "hero" || config.variant === "overlay";
---

<div
  class={`card size-${gridSize} ${isFullBleed ? "card--full-bleed" : ""}`}
  style={`
    ${background ? `background:${background};` : ""}
    ${textColor ? `color:${textColor};` : ""}
    ${rotation !== 0 ? `transform: rotate(${rotation}deg);` : ""}
  `}
>
  {config.variant === "text"      && <TextCard config={config} />}
  {config.variant === "media"     && <MediaCard config={config} />}
  {config.variant === "sticker"   && <StickerCard config={config} />}
  {config.variant === "hero"      && <HeroCard config={config} />}
  {config.variant === "post-list" && <PostListCard config={config} />}
  {config.variant === "overlay"   && <OverlayCard config={config} />}
</div>

<style>
.card {
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: var(--space-lg);
  border-radius: var(--radius-xl);
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  box-shadow: var(--shadow-md);
  overflow: hidden;
  min-height: 280px;
  transition:
    transform 0.25s cubic-bezier(.2,.8,.2,1),
    box-shadow 0.25s ease;
}

.card:hover {
  transform: translateY(-6px);
  box-shadow: var(--shadow-lg);
}

/* Full-bleed: بدون padding وبدون glass background */
.card--full-bleed {
  padding: 0;
  background: none;
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  border: none;
  box-shadow: none;
  min-height: 280px;
}

.card--full-bleed:hover {
  transform: none;
  box-shadow: none;
}

[data-theme="dark"] .card {
  background: var(--glass-bg-dark);
  border-color: var(--glass-border-dark);
}
</style>
